---
title: Churn Prediction
author: Mohammed Hafrate
date: '2020-10-29'
slug: churn-prediction.en-us
categories: ["R"]
tags: ["R", "machine learning", "predictive analytics", "customer churn"]
keywords:
  - tech
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

This is code that accompanies a [book](https://www.dpunkt.de/buecher/13208/9783864906107-data-science.html) chapter on customer churn that I have written for the German dpunkt Verlag. The book is in German and will probably appear in February: [https://www.dpunkt.de/buecher/13208/9783864906107-data-science.html](https://www.dpunkt.de/buecher/13208/9783864906107-data-science.html).

The code you find below can be used to recreate all figures and analyses from this book chapter. Because the content is exclusively for the book, my descriptions around the code had to be minimal. But I'm sure, you can get the gist, even without the book. ;-)

# Inspiration & Sources

Thank you to the following people for providing excellent code examples about customer churn:

- Matt Dancho: http://www.business-science.io/business/2017/11/28/customer_churn_analysis_keras.html
- JJ Allaire: https://github.com/rstudio/keras-customer-churn
- Susan Li: https://towardsdatascience.com/predict-customer-churn-with-r-9e62357d47b4
- John Sullivan: https://jtsulliv.github.io/churn-eda/

# Setup

All analyses are done in R using RStudio. For detailed session information including R version, operating system and package versions, see the `sessionInfo()` output at the end of this document.

All figures are produced with ggplot2.

- Libraries

```{r}
# Load libraries
library(tidyverse) # for tidy data analysis
library(readr)     # for fast reading of input files
library(caret)     # for convenient splitting
library(mice)      # mice package for Multivariate Imputation by Chained Equations (MICE)
library(keras)     # for neural nets
library(lime)      # for explaining neural nets
library(rsample)   # for splitting training and test data
library(recipes)   # for preprocessing
library(yardstick) # for evaluation
library(ggthemes)  # for additional plotting themes
library(corrplot)  # for correlation
theme_set(theme_minimal())
```

<!--more-->
